{% extends "wagtailadmin/base.html" %}
{% load i18n %}
{% block titletag %}{% blocktrans with title=page.get_admin_display_title %}Copy {{ title }}{% endblocktrans %}{% endblock %}
{% block content %}
    {% trans "Copy" as copy_str %}
    {% include "wagtailadmin/shared/header.html" with title=copy_str subtitle=page.get_admin_display_title icon="doc-empty-inverse" %}
    <div class="nice-padding">
        <form id="form" path="{% url 'preload-add-page' app_name=app_label model_name=model_name parent_pk=2 %}" method="POST" novalidate>
            {% for name, value in cluster_data %}
                <input type="hidden" value="{{ value }}" name="{{ name }}" id="id_{{ name }}" />
            {% endfor %}
            {% for field in form.visible_fields %}
                {% if include_slug or field.name != 'slug_en_gb' %} 
                    <input type="hidden" value="{{ field.value }}" name="{{ field.name }}" id="{{ field.id_for_label }}" />
                {% endif %}
            {% endfor %}
            <input type="hidden" name="next" value="{{ next }}" />
            <ul class="fields">
                {% include "wagtailadmin/shared/field_as_li.html" with field=environment_form.environment %}
            </ul>
            <input type="submit" value="{% trans 'Copy this page' %}" class="button">
        </form>
    </div>
    <script>
        var form = document.getElementById('form');
        var environmentField = document.getElementById('id_environment');
        function setAction() {
            form.action = environmentField.value + form.getAttribute('path');
        }
        environmentField.addEventListener('change', setAction);
        setAction();
    </script>
{% endblock %}

{% block extra_js %}
    {{ block.super }}
    {% include "wagtailadmin/pages/_editor_js.html" %}
{% endblock %}
